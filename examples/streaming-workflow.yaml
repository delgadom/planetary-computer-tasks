# pctasks workflow create streaming-workflow.yaml
#   - Create the record in Cosmos
#   - *not* create anything in Kubernetes
# pctasks workflow submit <id>
#   - Create the Kubernetes Deployment

name: "Streaming workflow example"
jobs:
  create-items:
    id: create-items
    tasks:
    - id: create-items
      image: "pccomponentstest.azurecr.io/pctasks-goes-glm:2023.2.27.0"
      task: pctasks.task.streaming:StreamingCreateItemsTask
      code:
        src: datasets/goes/goes-glm/goes_glm.py
      args:
        queue_url: "https://pclowlatency.queue.core.windows.net/goes-glm"
        visibility_timeout: 30
        options:
          skip_validation: false
        cosmos_endpoint: https://pclowlatencytesttom.documents.azure.com:443/
        db_name: lowlatencydb
        container_name: items
        create_items_function: goes_glm:GoesGlmCollection.create_item
        min_replica_count: 0
        max_replica_count: 10
        polling_interval: 30
        trigger_queue_length: 100
        collection_id: "goes-glm"
      schema_version: 1.0.0
is_streaming: True
schema_version: 1.0.0
id: goes-glm-streaming-test
dataset: goes_glm